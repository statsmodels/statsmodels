
#Output from test_generator.py using NIST data and results
#It is advised that no changes are done in this file.
#Any desired modification should be generalised and added
#in test_generator.py
import numpy as np
import statsmodels.api as sm
from statsmodels.miscmodels.nonlinls import NonlinearLS

class funcGauss1(NonlinearLS):

    def expr(self, params, exog=None):
        if exog is None:
            x = self.exog
        else:
            x = exog
        b1, b2, b3, b4, b5, b6, b7, b8 = params
        return b1*np.exp(-b2*x) + b3*np.exp(-(x-b4)**2/b5**2) + b6*np.exp(-(x-b7)**2/b8**2)

class funcGauss1_J(NonlinearLS):

    def expr(self, params, exog=None):
        if exog is None:
            x = self.exog
        else:
            x = exog
        b1, b2, b3, b4, b5, b6, b7, b8 = params
        return b1*np.exp(-b2*x) + b3*np.exp(-(x-b4)**2/b5**2) + b6*np.exp(-(x-b7)**2/b8**2)

    def jacobian(self, params, exog=None):
        if exog is None:
            x = self.exog
        else:
            x = exog
        b1, b2, b3, b4, b5, b6, b7, b8 = params
        return np.column_stack([np.exp(-b2*x),-b1*x*np.exp(-b2*x),np.exp(-(x-b4)**2/b5**2),(2*(x-b4)/b5**2)*b3*np.exp(-(x-b4)**2/b5**2),(2*(x-b4)**2/b5**3)*b3*np.exp(-(x-b4)**2/b5**2),np.exp(-(x-b7)**2/b8**2),(2*(x-b7)/b8**2)*b6*np.exp(-(x-b7)**2/b8**2),(2*(x-b7)**2/b8**3)*b6*np.exp(-(x-b7)**2/b8**2)])

class TestNonlinearLS(object):
    def setup(self):
        x = np.array([1.0,
                   2.0,
                   3.0,
                   4.0,
                   5.0,
                   6.0,
                   7.0,
                   8.0,
                   9.0,
                   10.0,
                   11.0,
                   12.0,
                   13.0,
                   14.0,
                   15.0,
                   16.0,
                   17.0,
                   18.0,
                   19.0,
                   20.0,
                   21.0,
                   22.0,
                   23.0,
                   24.0,
                   25.0,
                   26.0,
                   27.0,
                   28.0,
                   29.0,
                   30.0,
                   31.0,
                   32.0,
                   33.0,
                   34.0,
                   35.0,
                   36.0,
                   37.0,
                   38.0,
                   39.0,
                   40.0,
                   41.0,
                   42.0,
                   43.0,
                   44.0,
                   45.0,
                   46.0,
                   47.0,
                   48.0,
                   49.0,
                   50.0,
                   51.0,
                   52.0,
                   53.0,
                   54.0,
                   55.0,
                   56.0,
                   57.0,
                   58.0,
                   59.0,
                   60.0,
                   61.0,
                   62.0,
                   63.0,
                   64.0,
                   65.0,
                   66.0,
                   67.0,
                   68.0,
                   69.0,
                   70.0,
                   71.0,
                   72.0,
                   73.0,
                   74.0,
                   75.0,
                   76.0,
                   77.0,
                   78.0,
                   79.0,
                   80.0,
                   81.0,
                   82.0,
                   83.0,
                   84.0,
                   85.0,
                   86.0,
                   87.0,
                   88.0,
                   89.0,
                   90.0,
                   91.0,
                   92.0,
                   93.0,
                   94.0,
                   95.0,
                   96.0,
                   97.0,
                   98.0,
                   99.0,
                   100.0,
                   101.0,
                   102.0,
                   103.0,
                   104.0,
                   105.0,
                   106.0,
                   107.0,
                   108.0,
                   109.0,
                   110.0,
                   111.0,
                   112.0,
                   113.0,
                   114.0,
                   115.0,
                   116.0,
                   117.0,
                   118.0,
                   119.0,
                   120.0,
                   121.0,
                   122.0,
                   123.0,
                   124.0,
                   125.0,
                   126.0,
                   127.0,
                   128.0,
                   129.0,
                   130.0,
                   131.0,
                   132.0,
                   133.0,
                   134.0,
                   135.0,
                   136.0,
                   137.0,
                   138.0,
                   139.0,
                   140.0,
                   141.0,
                   142.0,
                   143.0,
                   144.0,
                   145.0,
                   146.0,
                   147.0,
                   148.0,
                   149.0,
                   150.0,
                   151.0,
                   152.0,
                   153.0,
                   154.0,
                   155.0,
                   156.0,
                   157.0,
                   158.0,
                   159.0,
                   160.0,
                   161.0,
                   162.0,
                   163.0,
                   164.0,
                   165.0,
                   166.0,
                   167.0,
                   168.0,
                   169.0,
                   170.0,
                   171.0,
                   172.0,
                   173.0,
                   174.0,
                   175.0,
                   176.0,
                   177.0,
                   178.0,
                   179.0,
                   180.0,
                   181.0,
                   182.0,
                   183.0,
                   184.0,
                   185.0,
                   186.0,
                   187.0,
                   188.0,
                   189.0,
                   190.0,
                   191.0,
                   192.0,
                   193.0,
                   194.0,
                   195.0,
                   196.0,
                   197.0,
                   198.0,
                   199.0,
                   200.0,
                   201.0,
                   202.0,
                   203.0,
                   204.0,
                   205.0,
                   206.0,
                   207.0,
                   208.0,
                   209.0,
                   210.0,
                   211.0,
                   212.0,
                   213.0,
                   214.0,
                   215.0,
                   216.0,
                   217.0,
                   218.0,
                   219.0,
                   220.0,
                   221.0,
                   222.0,
                   223.0,
                   224.0,
                   225.0,
                   226.0,
                   227.0,
                   228.0,
                   229.0,
                   230.0,
                   231.0,
                   232.0,
                   233.0,
                   234.0,
                   235.0,
                   236.0,
                   237.0,
                   238.0,
                   239.0,
                   240.0,
                   241.0,
                   242.0,
                   243.0,
                   244.0,
                   245.0,
                   246.0,
                   247.0,
                   248.0,
                   249.0,
                   250.0])
        y = np.array([97.62227,
                   97.80724,
                   96.62247,
                   92.59022,
                   91.23869,
                   95.32704,
                   90.3504,
                   89.46235,
                   91.7252,
                   89.86916,
                   86.88076,
                   85.9436,
                   87.60686,
                   86.25839,
                   80.74976,
                   83.03551,
                   88.25837,
                   82.01316,
                   82.74098,
                   83.30034,
                   81.2785,
                   81.85506,
                   80.75195,
                   80.09573,
                   81.07633,
                   78.81542,
                   78.38596,
                   79.93386,
                   79.48474,
                   79.95942,
                   76.10691,
                   78.3983,
                   81.4306,
                   82.48867,
                   81.65462,
                   80.84323,
                   88.68663,
                   84.74438,
                   86.83934,
                   85.97739,
                   91.28509,
                   97.22411,
                   93.51733,
                   94.10159,
                   101.9176,
                   98.43134,
                   110.4214,
                   107.6628,
                   111.7288,
                   116.5115,
                   120.7609,
                   123.9553,
                   124.2437,
                   130.7996,
                   133.296,
                   130.7788,
                   132.0565,
                   138.6584,
                   142.9252,
                   142.7215,
                   144.1249,
                   147.4377,
                   148.2647,
                   152.0519,
                   147.3863,
                   149.2074,
                   148.9537,
                   144.5876,
                   148.1226,
                   148.0144,
                   143.8893,
                   140.9088,
                   143.4434,
                   139.3938,
                   135.9878,
                   136.3927,
                   126.7262,
                   124.4487,
                   122.8647,
                   113.8557,
                   113.7037,
                   106.8407,
                   107.0034,
                   102.4629,
                   96.09296,
                   94.57555,
                   86.98824,
                   84.90154,
                   81.18023,
                   76.40117,
                   67.092,
                   72.67155,
                   68.10848,
                   67.99088,
                   63.34094,
                   60.55253,
                   56.18687,
                   53.64482,
                   53.70307,
                   48.07893,
                   42.21258,
                   45.65181,
                   41.69728,
                   41.24946,
                   39.21349,
                   37.71696,
                   36.68395,
                   37.30393,
                   37.43277,
                   37.45012,
                   32.64648,
                   31.84347,
                   31.39951,
                   26.68912,
                   32.25323,
                   27.61008,
                   33.58649,
                   28.10714,
                   30.26428,
                   28.01648,
                   29.11021,
                   23.02099,
                   25.65091,
                   28.50295,
                   25.23701,
                   26.13828,
                   33.5326,
                   29.25195,
                   27.09847,
                   26.52999,
                   25.52401,
                   26.69218,
                   24.55269,
                   27.71763,
                   25.20297,
                   25.61483,
                   25.06893,
                   27.6393,
                   24.94851,
                   25.86806,
                   22.48183,
                   26.90045,
                   25.39919,
                   17.90614,
                   23.76039,
                   25.89689,
                   27.64231,
                   22.86101,
                   26.47003,
                   23.72888,
                   27.54334,
                   30.52683,
                   28.07261,
                   34.92815,
                   28.29194,
                   34.19161,
                   35.41207,
                   37.09336,
                   40.9833,
                   39.53923,
                   47.80123,
                   47.46305,
                   51.04166,
                   54.58065,
                   57.53001,
                   61.42089,
                   62.79032,
                   68.51455,
                   70.23053,
                   74.42776,
                   76.59911,
                   81.62053,
                   83.42208,
                   79.17451,
                   88.56985,
                   85.66525,
                   86.55502,
                   90.65907,
                   84.2729,
                   85.7222,
                   83.10702,
                   82.16884,
                   80.42568,
                   78.15692,
                   79.79691,
                   77.84378,
                   74.50327,
                   71.57289,
                   65.88031,
                   65.01385,
                   60.19582,
                   59.66726,
                   52.95478,
                   53.87792,
                   44.91274,
                   41.09909,
                   41.68018,
                   34.53379,
                   34.86419,
                   33.14787,
                   29.58864,
                   27.29462,
                   21.91439,
                   19.08159,
                   24.9029,
                   19.82341,
                   16.75551,
                   18.24558,
                   17.23549,
                   16.34934,
                   13.71285,
                   14.75676,
                   13.97169,
                   12.42867,
                   14.35519,
                   7.703309,
                   10.23441,
                   11.78315,
                   13.87768,
                   4.5357,
                   10.05928,
                   8.424824,
                   10.53312,
                   9.602255,
                   7.877514,
                   6.258121,
                   8.899865,
                   7.877754,
                   12.51191,
                   10.66205,
                   6.0354,
                   6.790655,
                   8.783535,
                   4.600288,
                   8.400915,
                   7.216561,
                   10.01741,
                   7.331278,
                   6.527863,
                   2.842001,
                   10.32507,
                   4.790995,
                   8.377101,
                   6.264445,
                   2.706213,
                   8.362329,
                   8.983658,
                   3.362571,
                   1.182746,
                   4.875359])
        self.Degrees_free=242
        self.Res_stddev=2.331798018
        self.Res_sum_squares=1315.8222432
        self.start_value2=[94.0, 0.0105, 99.0, 63.0, 25.0, 71.0, 180.0, 20.0]
        self.Cert_parameters=[98.778210871, 0.010497276517, 100.48990633, 67.481111276, 23.12977336, 71.994503004, 178.99805021, 18.389389025]
        self.start_value1=[97.0, 0.009, 100.0, 65.0, 20.0, 70.0, 178.0, 16.5]
        self.Cert_stddev=[0.5752731273, 0.00011406289017, 0.58831775752, 0.10460593412, 0.17439951146, 0.62622793913, 0.12436988217, 0.20134312832]
        self.Nobs_data=250
        self.nparams=8

        mod1 = funcGauss1(y, x)
        self.res_start1 = mod1.fit(self.start_value1)
        mod2 = funcGauss1(y, x)
        self.res_start2 = mod2.fit(self.start_value2)
        mod1_J = funcGauss1_J(y, x)
        self.resJ_start1 = mod1_J.fit(self.start_value1)
        mod2_J = funcGauss1_J(y, x)
        self.resJ_start2 = mod2_J.fit(self.start_value2)
