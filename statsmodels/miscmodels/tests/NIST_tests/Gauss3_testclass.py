
#Output from test_generator.py using NIST data and results
#It is advised that no changes are done in this file.
#Any desired modification should be generalised and added
#in test_generator.py
import numpy as np
import statsmodels.api as sm
from statsmodels.miscmodels.nonlinls import NonlinearLS

class funcGauss3(NonlinearLS):

    def expr(self, params, exog=None):
        if exog is None:
            x = self.exog
        else:
            x = exog
        b1, b2, b3, b4, b5, b6, b7, b8 = params
        return b1*np.exp(-b2*x) + b3*np.exp(-(x-b4)**2/b5**2) + b6*np.exp(-(x-b7)**2/b8**2)

class funcGauss3_J(NonlinearLS):

    def expr(self, params, exog=None):
        if exog is None:
            x = self.exog
        else:
            x = exog
        b1, b2, b3, b4, b5, b6, b7, b8 = params
        return b1*np.exp(-b2*x) + b3*np.exp(-(x-b4)**2/b5**2) + b6*np.exp(-(x-b7)**2/b8**2)

    def jacobian(self, params, exog=None):
        if exog is None:
            x = self.exog
        else:
            x = exog
        b1, b2, b3, b4, b5, b6, b7, b8 = params
        return np.column_stack([np.exp(-b2*x),(-b2)*b1*np.exp(-b2*x), np.exp(-(x-b4)**2/b5**2), b3*np.exp(-(x-b4)**2/b5**2)*(2*(x-b4)/b5**2),b3*np.exp(-(x-b4)**2/b5**2)*(2*(x-b4)**2/b5**3), np.exp(-(x-b7)**2/b8**2),b6*np.exp(-(x-b7)**2/b8**2)*(2*(x-b7)/b8**2),b6*np.exp(-(x-b7)**2/b8**2)*(2*(x-b7)**2/b8**3)])

class TestNonlinearLS(object):
    def setup(self):
        x = np.array([1.0,
                   2.0,
                   3.0,
                   4.0,
                   5.0,
                   6.0,
                   7.0,
                   8.0,
                   9.0,
                   10.0,
                   11.0,
                   12.0,
                   13.0,
                   14.0,
                   15.0,
                   16.0,
                   17.0,
                   18.0,
                   19.0,
                   20.0,
                   21.0,
                   22.0,
                   23.0,
                   24.0,
                   25.0,
                   26.0,
                   27.0,
                   28.0,
                   29.0,
                   30.0,
                   31.0,
                   32.0,
                   33.0,
                   34.0,
                   35.0,
                   36.0,
                   37.0,
                   38.0,
                   39.0,
                   40.0,
                   41.0,
                   42.0,
                   43.0,
                   44.0,
                   45.0,
                   46.0,
                   47.0,
                   48.0,
                   49.0,
                   50.0,
                   51.0,
                   52.0,
                   53.0,
                   54.0,
                   55.0,
                   56.0,
                   57.0,
                   58.0,
                   59.0,
                   60.0,
                   61.0,
                   62.0,
                   63.0,
                   64.0,
                   65.0,
                   66.0,
                   67.0,
                   68.0,
                   69.0,
                   70.0,
                   71.0,
                   72.0,
                   73.0,
                   74.0,
                   75.0,
                   76.0,
                   77.0,
                   78.0,
                   79.0,
                   80.0,
                   81.0,
                   82.0,
                   83.0,
                   84.0,
                   85.0,
                   86.0,
                   87.0,
                   88.0,
                   89.0,
                   90.0,
                   91.0,
                   92.0,
                   93.0,
                   94.0,
                   95.0,
                   96.0,
                   97.0,
                   98.0,
                   99.0,
                   100.0,
                   101.0,
                   102.0,
                   103.0,
                   104.0,
                   105.0,
                   106.0,
                   107.0,
                   108.0,
                   109.0,
                   110.0,
                   111.0,
                   112.0,
                   113.0,
                   114.0,
                   115.0,
                   116.0,
                   117.0,
                   118.0,
                   119.0,
                   120.0,
                   121.0,
                   122.0,
                   123.0,
                   124.0,
                   125.0,
                   126.0,
                   127.0,
                   128.0,
                   129.0,
                   130.0,
                   131.0,
                   132.0,
                   133.0,
                   134.0,
                   135.0,
                   136.0,
                   137.0,
                   138.0,
                   139.0,
                   140.0,
                   141.0,
                   142.0,
                   143.0,
                   144.0,
                   145.0,
                   146.0,
                   147.0,
                   148.0,
                   149.0,
                   150.0,
                   151.0,
                   152.0,
                   153.0,
                   154.0,
                   155.0,
                   156.0,
                   157.0,
                   158.0,
                   159.0,
                   160.0,
                   161.0,
                   162.0,
                   163.0,
                   164.0,
                   165.0,
                   166.0,
                   167.0,
                   168.0,
                   169.0,
                   170.0,
                   171.0,
                   172.0,
                   173.0,
                   174.0,
                   175.0,
                   176.0,
                   177.0,
                   178.0,
                   179.0,
                   180.0,
                   181.0,
                   182.0,
                   183.0,
                   184.0,
                   185.0,
                   186.0,
                   187.0,
                   188.0,
                   189.0,
                   190.0,
                   191.0,
                   192.0,
                   193.0,
                   194.0,
                   195.0,
                   196.0,
                   197.0,
                   198.0,
                   199.0,
                   200.0,
                   201.0,
                   202.0,
                   203.0,
                   204.0,
                   205.0,
                   206.0,
                   207.0,
                   208.0,
                   209.0,
                   210.0,
                   211.0,
                   212.0,
                   213.0,
                   214.0,
                   215.0,
                   216.0,
                   217.0,
                   218.0,
                   219.0,
                   220.0,
                   221.0,
                   222.0,
                   223.0,
                   224.0,
                   225.0,
                   226.0,
                   227.0,
                   228.0,
                   229.0,
                   230.0,
                   231.0,
                   232.0,
                   233.0,
                   234.0,
                   235.0,
                   236.0,
                   237.0,
                   238.0,
                   239.0,
                   240.0,
                   241.0,
                   242.0,
                   243.0,
                   244.0,
                   245.0,
                   246.0,
                   247.0,
                   248.0,
                   249.0,
                   250.0])
        y = np.array([97.58776,
                   97.76344,
                   96.56705,
                   92.52037,
                   91.15097,
                   95.21728,
                   90.21355,
                   89.29235,
                   91.51479,
                   89.60965,
                   86.56187,
                   85.55315,
                   87.13053,
                   85.67938,
                   80.04849,
                   82.18922,
                   87.24078,
                   80.79401,
                   81.28564,
                   81.56932,
                   79.22703,
                   79.43259,
                   77.90174,
                   76.75438,
                   77.17338,
                   74.27296,
                   73.1183,
                   73.84732,
                   72.47746,
                   71.92128,
                   66.91962,
                   67.93554,
                   69.55841,
                   69.06592,
                   66.53371,
                   63.87094,
                   69.70526,
                   63.59295,
                   63.35509,
                   59.99747,
                   62.64843,
                   65.77345,
                   59.10141,
                   56.5775,
                   61.15313,
                   54.30767,
                   62.83535,
                   56.52957,
                   56.98427,
                   58.11459,
                   58.69576,
                   58.23322,
                   54.9049,
                   57.91442,
                   56.96629,
                   51.13831,
                   49.27123,
                   52.92668,
                   54.47693,
                   51.8171,
                   51.05401,
                   52.51731,
                   51.8371,
                   54.48196,
                   49.05859,
                   50.52315,
                   50.32755,
                   46.44419,
                   50.89281,
                   52.13203,
                   49.78741,
                   49.01637,
                   54.18198,
                   53.17456,
                   53.20827,
                   57.43459,
                   51.95282,
                   54.20282,
                   57.46687,
                   53.60268,
                   58.86728,
                   57.66652,
                   63.71034,
                   65.24244,
                   65.10878,
                   69.96313,
                   68.85475,
                   73.32574,
                   76.21241,
                   78.06311,
                   75.37701,
                   87.54449,
                   89.50588,
                   95.82098,
                   97.4839,
                   100.8607,
                   102.4851,
                   105.7311,
                   111.3489,
                   111.0305,
                   110.192,
                   118.3581,
                   118.8086,
                   122.4249,
                   124.0953,
                   125.9337,
                   127.8533,
                   131.0361,
                   133.3343,
                   135.1278,
                   131.7113,
                   131.9151,
                   132.1107,
                   127.6898,
                   133.2148,
                   128.2296,
                   133.5902,
                   127.2539,
                   128.3482,
                   124.8694,
                   124.6031,
                   117.0648,
                   118.1966,
                   119.5408,
                   114.7946,
                   114.278,
                   120.3484,
                   114.8647,
                   111.6514,
                   110.1826,
                   108.4461,
                   109.0571,
                   106.5308,
                   109.4691,
                   106.8709,
                   107.3192,
                   106.9,
                   109.6526,
                   107.1602,
                   108.2509,
                   104.9631,
                   109.3601,
                   107.6696,
                   99.77286,
                   104.9644,
                   106.1376,
                   106.5816,
                   100.1286,
                   101.6691,
                   96.44254,
                   97.34169,
                   96.97412,
                   90.7346,
                   93.37949,
                   82.12331,
                   83.01657,
                   78.8736,
                   74.86971,
                   72.79341,
                   65.14744,
                   67.02127,
                   60.16136,
                   57.13996,
                   54.05769,
                   50.42265,
                   47.8243,
                   42.85748,
                   42.45495,
                   38.30808,
                   36.95794,
                   33.94543,
                   34.19017,
                   31.66097,
                   23.56172,
                   29.61143,
                   23.88765,
                   22.49812,
                   24.86901,
                   17.29481,
                   18.09291,
                   15.34813,
                   14.77997,
                   13.87832,
                   12.88891,
                   16.20763,
                   16.29024,
                   15.29712,
                   14.97839,
                   12.1133,
                   14.24168,
                   12.53824,
                   15.19818,
                   11.70478,
                   15.83745,
                   10.03585,
                   9.307574,
                   12.868,
                   8.571671,
                   11.60415,
                   12.42772,
                   11.23627,
                   11.13198,
                   7.761117,
                   6.75825,
                   14.23375,
                   10.63876,
                   8.893581,
                   11.55398,
                   11.57221,
                   11.58347,
                   9.724857,
                   11.43854,
                   11.22636,
                   10.17015,
                   12.50765,
                   6.200494,
                   9.018902,
                   10.80557,
                   13.09591,
                   3.914033,
                   9.567723,
                   8.038338,
                   10.23096,
                   9.367358,
                   7.695937,
                   6.118552,
                   8.793192,
                   7.796682,
                   12.45064,
                   10.61601,
                   6.001,
                   6.765096,
                   8.764652,
                   4.586417,
                   8.390782,
                   7.209201,
                   10.01209,
                   7.327461,
                   6.525136,
                   2.840065,
                   10.32371,
                   4.790035,
                   8.376431,
                   6.26398,
                   2.705892,
                   8.362109,
                   8.983507,
                   3.362469,
                   1.182678,
                   4.875312])
        self.Degrees_free=242
        self.Res_stddev=2.2677077625
        self.Res_sum_squares=1244.484636
        self.start_value2=[96.0, 0.0096, 80.0, 110.0, 25.0, 74.0, 139.0, 25.0]
        self.Cert_parameters=[98.94036897, 0.010945879335, 100.69553078, 111.63619459, 23.300500029, 73.705031418, 147.76164251, 19.66822123]
        self.start_value1=[94.9, 0.009, 90.1, 113.0, 20.0, 73.8, 140.0, 20.0]
        self.Cert_stddev=[0.53005192833, 0.00012554058911, 0.81256587317, 0.35317859757, 0.36584783023, 1.2091239082, 0.40488183351, 0.37806634336]
        self.Nobs_data=250
        self.nparams=8

        mod1 = funcGauss3(y, x)
        self.res_start1 = mod1.fit(self.start_value1)
        mod2 = funcGauss3(y, x)
        self.res_start2 = mod2.fit(self.start_value2)
        mod1_J = funcGauss3_J(y, x)
        self.resJ_start1 = mod1_J.fit(self.start_value1)
        mod2_J = funcGauss3_J(y, x)
        self.resJ_start2 = mod2_J.fit(self.start_value2)
