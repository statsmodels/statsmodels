
#Output from test_generator.py using NIST data and results
#It is advised that no changes are done in this file.
#Any desired modification should be generalised and added
#in test_generator.py
import numpy as np
import statsmodels.api as sm
from statsmodels.miscmodels.nonlinls import NonlinearLS

class funcGauss2(NonlinearLS):

    def expr(self, params, exog=None):
        if exog is None:
            x = self.exog
        else:
            x = exog
        b1, b2, b3, b4, b5, b6, b7, b8 = params
        return b1*np.exp(-b2*x) + b3*np.exp(-(x-b4)**2/b5**2)+b6*np.exp(-(x-b7)**2/b8**2)

class funcGauss2_J(NonlinearLS):

    def expr(self, params, exog=None):
        if exog is None:
            x = self.exog
        else:
            x = exog
        b1, b2, b3, b4, b5, b6, b7, b8 = params
        return b1*np.exp(-b2*x) + b3*np.exp(-(x-b4)**2/b5**2)+b6*np.exp(-(x-b7)**2/b8**2)

    def jacobian(self, params, exog=None):
        if exog is None:
            x = self.exog
        else:
            x = exog
        b1, b2, b3, b4, b5, b6, b7, b8 = params
        return np.column_stack([np.exp(-b2*x),-b1*x*np.exp(-b2*x),np.exp(-(x-b4)**2/b5**2),(2*(x-b4)/b5**2)*b3*np.exp(-(x-b4)**2/b5**2),(2*(x-b4)**2/b5**3)*b3*np.exp(-(x-b4)**2/b5**2),np.exp(-(x-b7)**2/b8**2),(2*(x-b7)/b8**2)*b6*np.exp(-(x-b7)**2/b8**2),(2*(x-b7)**2/b8**3)*b6*np.exp(-(x-b7)**2/b8**2)])

class TestNonlinearLS(object):
    def setup(self):
        x = np.array([1.0,
                   2.0,
                   3.0,
                   4.0,
                   5.0,
                   6.0,
                   7.0,
                   8.0,
                   9.0,
                   10.0,
                   11.0,
                   12.0,
                   13.0,
                   14.0,
                   15.0,
                   16.0,
                   17.0,
                   18.0,
                   19.0,
                   20.0,
                   21.0,
                   22.0,
                   23.0,
                   24.0,
                   25.0,
                   26.0,
                   27.0,
                   28.0,
                   29.0,
                   30.0,
                   31.0,
                   32.0,
                   33.0,
                   34.0,
                   35.0,
                   36.0,
                   37.0,
                   38.0,
                   39.0,
                   40.0,
                   41.0,
                   42.0,
                   43.0,
                   44.0,
                   45.0,
                   46.0,
                   47.0,
                   48.0,
                   49.0,
                   50.0,
                   51.0,
                   52.0,
                   53.0,
                   54.0,
                   55.0,
                   56.0,
                   57.0,
                   58.0,
                   59.0,
                   60.0,
                   61.0,
                   62.0,
                   63.0,
                   64.0,
                   65.0,
                   66.0,
                   67.0,
                   68.0,
                   69.0,
                   70.0,
                   71.0,
                   72.0,
                   73.0,
                   74.0,
                   75.0,
                   76.0,
                   77.0,
                   78.0,
                   79.0,
                   80.0,
                   81.0,
                   82.0,
                   83.0,
                   84.0,
                   85.0,
                   86.0,
                   87.0,
                   88.0,
                   89.0,
                   90.0,
                   91.0,
                   92.0,
                   93.0,
                   94.0,
                   95.0,
                   96.0,
                   97.0,
                   98.0,
                   99.0,
                   100.0,
                   101.0,
                   102.0,
                   103.0,
                   104.0,
                   105.0,
                   106.0,
                   107.0,
                   108.0,
                   109.0,
                   110.0,
                   111.0,
                   112.0,
                   113.0,
                   114.0,
                   115.0,
                   116.0,
                   117.0,
                   118.0,
                   119.0,
                   120.0,
                   121.0,
                   122.0,
                   123.0,
                   124.0,
                   125.0,
                   126.0,
                   127.0,
                   128.0,
                   129.0,
                   130.0,
                   131.0,
                   132.0,
                   133.0,
                   134.0,
                   135.0,
                   136.0,
                   137.0,
                   138.0,
                   139.0,
                   140.0,
                   141.0,
                   142.0,
                   143.0,
                   144.0,
                   145.0,
                   146.0,
                   147.0,
                   148.0,
                   149.0,
                   150.0,
                   151.0,
                   152.0,
                   153.0,
                   154.0,
                   155.0,
                   156.0,
                   157.0,
                   158.0,
                   159.0,
                   160.0,
                   161.0,
                   162.0,
                   163.0,
                   164.0,
                   165.0,
                   166.0,
                   167.0,
                   168.0,
                   169.0,
                   170.0,
                   171.0,
                   172.0,
                   173.0,
                   174.0,
                   175.0,
                   176.0,
                   177.0,
                   178.0,
                   179.0,
                   180.0,
                   181.0,
                   182.0,
                   183.0,
                   184.0,
                   185.0,
                   186.0,
                   187.0,
                   188.0,
                   189.0,
                   190.0,
                   191.0,
                   192.0,
                   193.0,
                   194.0,
                   195.0,
                   196.0,
                   197.0,
                   198.0,
                   199.0,
                   200.0,
                   201.0,
                   202.0,
                   203.0,
                   204.0,
                   205.0,
                   206.0,
                   207.0,
                   208.0,
                   209.0,
                   210.0,
                   211.0,
                   212.0,
                   213.0,
                   214.0,
                   215.0,
                   216.0,
                   217.0,
                   218.0,
                   219.0,
                   220.0,
                   221.0,
                   222.0,
                   223.0,
                   224.0,
                   225.0,
                   226.0,
                   227.0,
                   228.0,
                   229.0,
                   230.0,
                   231.0,
                   232.0,
                   233.0,
                   234.0,
                   235.0,
                   236.0,
                   237.0,
                   238.0,
                   239.0,
                   240.0,
                   241.0,
                   242.0,
                   243.0,
                   244.0,
                   245.0,
                   246.0,
                   247.0,
                   248.0,
                   249.0,
                   250.0])
        y = np.array([97.58776,
                   97.76344,
                   96.56705,
                   92.52037,
                   91.15097,
                   95.21728,
                   90.21355,
                   89.29235,
                   91.51479,
                   89.60966,
                   86.56187,
                   85.55316,
                   87.13054,
                   85.6794,
                   80.04851,
                   82.18925,
                   87.24081,
                   80.79407,
                   81.2857,
                   81.5694,
                   79.22715,
                   79.43275,
                   77.90195,
                   76.75468,
                   77.17377,
                   74.27348,
                   73.119,
                   73.84826,
                   72.4787,
                   71.92292,
                   66.92176,
                   67.93835,
                   69.56207,
                   69.07066,
                   66.53983,
                   63.87883,
                   69.71537,
                   63.60588,
                   63.37154,
                   60.01835,
                   62.67481,
                   65.80666,
                   59.14304,
                   56.62951,
                   61.21785,
                   54.3879,
                   62.93443,
                   56.65144,
                   57.13362,
                   58.29689,
                   58.91744,
                   58.50172,
                   55.22885,
                   58.30375,
                   57.43237,
                   51.69407,
                   49.93132,
                   53.7076,
                   55.39712,
                   52.89709,
                   52.31649,
                   53.9872,
                   53.54158,
                   56.45046,
                   51.32276,
                   53.11676,
                   53.28631,
                   49.80555,
                   54.69564,
                   56.41627,
                   54.59362,
                   54.3852,
                   60.15354,
                   59.78773,
                   60.49995,
                   65.43885,
                   60.70001,
                   63.71865,
                   67.77139,
                   64.70934,
                   70.78193,
                   70.38651,
                   77.22359,
                   79.52665,
                   80.13077,
                   85.67823,
                   85.20647,
                   90.24548,
                   93.61953,
                   95.86509,
                   93.46992,
                   105.8137,
                   107.8269,
                   114.0607,
                   115.5019,
                   118.511,
                   119.6177,
                   122.194,
                   126.9903,
                   125.7005,
                   123.7447,
                   130.6543,
                   129.7168,
                   131.824,
                   131.8759,
                   131.9994,
                   132.1221,
                   133.4414,
                   133.8252,
                   133.6695,
                   128.2851,
                   126.5182,
                   124.755,
                   118.4016,
                   122.0334,
                   115.2059,
                   118.7856,
                   110.7387,
                   110.2003,
                   105.1729,
                   103.4472,
                   94.5428,
                   94.40526,
                   94.57964,
                   88.76605,
                   87.28747,
                   92.50443,
                   86.27997,
                   82.44307,
                   80.47367,
                   78.36608,
                   78.74307,
                   76.12786,
                   79.13108,
                   76.76062,
                   77.60769,
                   77.76633,
                   81.2822,
                   79.74307,
                   81.97964,
                   80.02952,
                   85.95232,
                   85.96838,
                   79.94789,
                   87.17023,
                   90.50992,
                   93.23373,
                   89.14803,
                   93.11492,
                   90.34337,
                   93.69421,
                   95.74256,
                   91.85105,
                   96.74503,
                   87.60996,
                   90.47012,
                   88.1169,
                   85.70673,
                   85.01361,
                   78.5304,
                   81.34148,
                   75.19295,
                   72.66115,
                   69.85504,
                   66.29476,
                   63.58502,
                   58.33847,
                   57.50766,
                   52.80498,
                   50.79319,
                   47.0349,
                   46.4709,
                   43.09016,
                   34.11531,
                   39.28235,
                   32.68386,
                   30.44056,
                   31.98932,
                   23.6333,
                   23.69643,
                   20.26812,
                   19.07074,
                   17.59544,
                   16.08785,
                   18.94267,
                   18.61354,
                   17.258,
                   16.62285,
                   13.48367,
                   15.37647,
                   13.47208,
                   15.96188,
                   12.32547,
                   16.3388,
                   10.43833,
                   9.628715,
                   13.12268,
                   8.772417,
                   11.76143,
                   12.5502,
                   11.33108,
                   11.20493,
                   7.816916,
                   6.800675,
                   14.26581,
                   10.66285,
                   8.911574,
                   11.56733,
                   11.58207,
                   11.59071,
                   9.730134,
                   11.44237,
                   11.22912,
                   10.17213,
                   12.50905,
                   6.201493,
                   9.019605,
                   10.80607,
                   13.09625,
                   3.914271,
                   9.567886,
                   8.038448,
                   10.23104,
                   9.36741,
                   7.695971,
                   6.118575,
                   8.793207,
                   7.796692,
                   12.45065,
                   10.61601,
                   6.001003,
                   6.765098,
                   8.764653,
                   4.586418,
                   8.390783,
                   7.209202,
                   10.01209,
                   7.327461,
                   6.525136,
                   2.840065,
                   10.32371,
                   4.790035,
                   8.376431,
                   6.26398,
                   2.705892,
                   8.362109,
                   8.983507,
                   3.362469,
                   1.182678,
                   4.875312])
        self.Degrees_free=242
        self.Res_stddev=2.2704790782
        self.Res_sum_squares=1247.5282092
        self.start_value2=[98.0, 0.0105, 103.0, 105.0, 20.0, 73.0, 150.0, 20.0]
        self.Cert_parameters=[99.018328406, 0.010994945399, 101.88022528, 107.03095519, 23.578584029, 72.045589471, 153.27010194, 19.525972636]
        self.start_value1=[96.0, 0.009, 103.0, 106.0, 18.0, 72.0, 151.0, 18.0]
        self.Cert_stddev=[0.53748766879, 0.00013335306766, 0.59217315772, 0.15006798316, 0.22695595067, 0.61721965884, 0.19466674341, 0.26416549393]
        self.Nobs_data=250
        self.nparams=8

        mod1 = funcGauss2(y, x)
        self.res_start1 = mod1.fit(self.start_value1)
        mod2 = funcGauss2(y, x)
        self.res_start2 = mod2.fit(self.start_value2)
        mod1_J = funcGauss2_J(y, x)
        self.resJ_start1 = mod1_J.fit(self.start_value1)
        mod2_J = funcGauss2_J(y, x)
        self.resJ_start2 = mod2_J.fit(self.start_value2)
