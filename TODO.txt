=========================
TODO for NIPY development
=========================

This list is currently not prioritized.

Testing framework
-----------------

- Fix the testing framework.  Remove the old test framework,
  neuroimaging.utils.testutils, make_doctest_suite.  Switch to using
  numpy's nost testing for numpy v1.2.

- Update all test modules to use the new test framework.

Tests
-----

Some issues specific to tests to cleanup.

- Remove creation of named temporary files "\*.nii", use NamedTemporaryFile
  instead in test modules:

  * modalities/fmri/tests/test_regression.py
  * modalities/fmri/fmristat/tests/test_model.py

- Affine is wrong in test_image.  Formats.Analyze reported 4x4 with
  MNI translation in 4th column.  PyniftiIO reports 5x5 with only one
  pixdim translation.

- NumpyTest.run() in __main__ blocks... doesn't instantiate NumpyTest.
  Tests cannot be run from command line.  Update to nose.

Trac Wiki
---------

- Update the README and INSTALL on the Trac Wiki.  These should
  reference a reST formatted version committed to the repository.
  Include information on downloading the fmri data and running the

  tests.

Nipy code base
--------------

- Update INSTALL and README so they are current.

- Delete neuroimaging/utils/path.py.  This custom path module does not
  provide any benefit over os.path.  Using a non-standard path module
  adds confusion to the code.  This will require going through the
  code base and updating all references to the path module.  Perhaps a
  good use of grin for a global search and replace.

- Convert from nipy datasource to numpy datasource.  Then remove
  nipy's datasource.py

- Delete any *weave* code.

- Remove configobj.

- What to do with nipy/doc?

Code Design Thoughts
--------------------

Perhaps there's a better place for this, but I wanted a central
location to dump thoughts that could be shared by the developers and
tracked easily.  I also don't like having to switch from my code
editor to a browser just to jot down an idea like this.

Image Class
-----------

- save function should accept filename or file-like object.  If I have
  an open file I would like to be able to pass that in also, instead
  of fp.name.  Happens in test code a lot.

- Add dtype options when saving. When saving images it uses the native
  dtype for the system.  Should be able to specify this.  in the
  test_file_roundtrip, self.img is a uint8, but is saved to tmpfile as
  float64.  Adding this would allow us to save images without the
  scaling being applied.

- In image._open(url, ...), should we test if the "url" is a PyNiftiIO
  object already? This was in the tests from 'old code' and passed::

    new = Image(self.img._data, self.img.grid)

  img._data is a PyNIftiIO object.  It works, but we should verify
  it's harmless otherwise prevent it from happening.

- Rename SamplingGrid to CoordinateMap.  Image.grid to Image.coordmap?

Image Iterators
---------------

- Cleanup the image iterators/generators.  I believe Jonathan was in
  the process of converting the code from using iterators to
  generators after the Paris Sprint.  This code transition is not
  complete.

Future Features
---------------

Egg support.  Look to revno 1642, a setup_egg.py that Gael had added.
This was removed as it did not work.

Add Fernando's nose fix for running doctests in extension code.

Place nipy-io-overhaul up on lp/cburns for matthew reference.

Place sandbox, visualization up to lp/cburns.

Move header_utils, utils, analyze_to_nifti and sliceplot to
sandbox/tools.  Files are currently in
nipy-sandbox/neuroimaging/data_io/formats.


